<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/third-part/css/ali.font.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="用户与权限管理1. 用户管理1. 1 登录MySQL服务器启动MySQL服务后，可以通过mysql命令来登录MySQL服务器，命令如下： 下面详细介绍命令中的参数： h参数后面接主机名或者主机IP，hostname为主机，hostIP为主机IP。 P参数后面接MySQL服务的端口，通过该参数连接到指定的端口。MySQL服务的默认端口是 3306 ，不使用该参数时自动连接到 3306 端口，port">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL用户与权限管理">
<meta property="og:url" content="http://example.com/2018/11/20/%E6%95%B0%E6%8D%AE%E5%BA%93/%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="技术日记簿">
<meta property="og:description" content="用户与权限管理1. 用户管理1. 1 登录MySQL服务器启动MySQL服务后，可以通过mysql命令来登录MySQL服务器，命令如下： 下面详细介绍命令中的参数： h参数后面接主机名或者主机IP，hostname为主机，hostIP为主机IP。 P参数后面接MySQL服务的端口，通过该参数连接到指定的端口。MySQL服务的默认端口是 3306 ，不使用该参数时自动连接到 3306 端口，port">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-11-20T14:16:14.000Z">
<meta property="article:modified_time" content="2023-06-13T12:01:14.063Z">
<meta property="article:author" content="wenchao">
<meta property="article:tag" content="Mysql">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2018/11/20/%E6%95%B0%E6%8D%AE%E5%BA%93/%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL用户与权限管理 | 技术日记簿</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="技术日记簿" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">技术日记簿</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/wangwenchao1991" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/11/20/%E6%95%B0%E6%8D%AE%E5%BA%93/%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="wenchao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="技术日记簿">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL用户与权限管理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-20 22:16:14" itemprop="dateCreated datePublished" datetime="2018-11-20T22:16:14+08:00">2018-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-13 20:01:14" itemprop="dateModified" datetime="2023-06-13T20:01:14+08:00">2023-06-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="用户与权限管理"><a href="#用户与权限管理" class="headerlink" title="用户与权限管理"></a>用户与权限管理</h1><h2 id="1-用户管理"><a href="#1-用户管理" class="headerlink" title="1. 用户管理"></a>1. 用户管理</h2><h2 id="1-1-登录MySQL服务器"><a href="#1-1-登录MySQL服务器" class="headerlink" title="1. 1 登录MySQL服务器"></a>1. 1 登录MySQL服务器</h2><p>启动MySQL服务后，可以通过mysql命令来登录MySQL服务器，命令如下：</p>
<h5 id="下面详细介绍命令中的参数："><a href="#下面详细介绍命令中的参数：" class="headerlink" title="下面详细介绍命令中的参数："></a>下面详细介绍命令中的参数：</h5><ul>
<li>h参数后面接主机名或者主机IP，hostname为主机，hostIP为主机IP。</li>
<li>P参数后面接MySQL服务的端口，通过该参数连接到指定的端口。MySQL服务的默认端口是 3306 ，<br>不使用该参数时自动连接到 3306 端口，port为连接的端口号。</li>
<li>u参数后面接用户名，username为用户名。</li>
<li>p参数会提示输入密码。<br>DatabaseName参数指明登录到哪一个数据库中。如果没有该参数，就会直接登录到MySQL数据库<br>中，然后可以使用USE命令来选择数据库。</li>
<li>e参数后面可以直接加SQL语句。登录MySQL服务器以后即可执行这个SQL语句，然后退出MySQL<br>服务器。</li>
</ul>
<p>举例：</p>
<h2 id="1-2-创建用户"><a href="#1-2-创建用户" class="headerlink" title="1. 2 创建用户"></a>1. 2 创建用户</h2><h5 id="CREATE-USER语句的基本语法形式如下："><a href="#CREATE-USER语句的基本语法形式如下：" class="headerlink" title="CREATE USER语句的基本语法形式如下："></a>CREATE USER语句的基本语法形式如下：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">用户名参数表示新建用户的账户，由用户（User）和主机名（Host）构成；</span><br><span class="line">“[ ]”表示可选，也就是说，可以指定用户登录时需要密码验证，也可以不指定密码验证，这样用户</span><br><span class="line">可以直接登录。不过，不指定密码的方式不安全，不推荐使用。如果指定密码值，这里需要使用</span><br><span class="line">IDENTIFIED BY指定明文密码值。</span><br><span class="line">CREATE USER语句可以同时创建多个用户。</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql –h hostname|hostIP –P port –u username –p DatabaseName –e &quot;SQL语句&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p -hlocalhost -P3306 mysql -e &quot;select host,user from user&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER 用户名 [IDENTIFIED BY &#x27;密码&#x27;][,用户名 [IDENTIFIED BY &#x27;密码&#x27;]];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER zhang3 IDENTIFIED BY &#x27;123123&#x27;;  # 默认host是 %</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;123456&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-修改用户"><a href="#1-3-修改用户" class="headerlink" title="1. 3 修改用户"></a>1. 3 修改用户</h3><h5 id="修改用户名："><a href="#修改用户名：" class="headerlink" title="修改用户名："></a>修改用户名：</h5><h3 id="1-4-删除用户"><a href="#1-4-删除用户" class="headerlink" title="1. 4 删除用户"></a>1. 4 删除用户</h3><h5 id="方式-1-：使用DROP方式删除（推荐）"><a href="#方式-1-：使用DROP方式删除（推荐）" class="headerlink" title="方式 1 ：使用DROP方式删除（推荐）"></a>方式 1 ：使用DROP方式删除（推荐）</h5><h5 id="使用DROP-USER语句来删除用户时，必须用于DROP-USER权限。DROP-USER语句的基本语法形式如下："><a href="#使用DROP-USER语句来删除用户时，必须用于DROP-USER权限。DROP-USER语句的基本语法形式如下：" class="headerlink" title="使用DROP USER语句来删除用户时，必须用于DROP USER权限。DROP USER语句的基本语法形式如下："></a>使用DROP USER语句来删除用户时，必须用于DROP USER权限。DROP USER语句的基本语法形式如下：</h5><h5 id="举例："><a href="#举例：" class="headerlink" title="举例："></a>举例：</h5><h5 id="方式-2-：使用DELETE方式删除"><a href="#方式-2-：使用DELETE方式删除" class="headerlink" title="方式 2 ：使用DELETE方式删除"></a>方式 2 ：使用DELETE方式删除</h5><h5 id="执行完DELETE命令后要使用FLUSH命令来使用户生效，命令如下："><a href="#执行完DELETE命令后要使用FLUSH命令来使用户生效，命令如下：" class="headerlink" title="执行完DELETE命令后要使用FLUSH命令来使用户生效，命令如下："></a>执行完DELETE命令后要使用FLUSH命令来使用户生效，命令如下：</h5><h5 id="举例：-1"><a href="#举例：-1" class="headerlink" title="举例："></a>举例：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注意：不推荐通过DELETE FROM USER u WHERE USER=&#x27;li4&#x27;进行删除，系统会有残留信息保</span><br><span class="line">留。而drop user命令会删除用户以及对应的权限，执行命令后你会发现mysql.user表和mysql.db表</span><br><span class="line">的相应记录都消失了。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE mysql.user SET USER=&#x27;li4&#x27; WHERE USER=&#x27;wang5&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER user[,user]...;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER li4 ;  # 默认删除host为%的用户</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM mysql.user WHERE Host=’hostname’ AND User=’username’;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM mysql.user WHERE Host=&#x27;localhost&#x27; AND User=&#x27;Emily&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h3 id="1-5-设置当前用户密码"><a href="#1-5-设置当前用户密码" class="headerlink" title="1. 5 设置当前用户密码"></a>1. 5 设置当前用户密码</h3><h5 id="旧的写法如下："><a href="#旧的写法如下：" class="headerlink" title="旧的写法如下："></a>旧的写法如下：</h5><h5 id="这里介绍推荐的写法："><a href="#这里介绍推荐的写法：" class="headerlink" title="这里介绍推荐的写法："></a>这里介绍推荐的写法：</h5><h5 id="1-使用ALTER-USER命令来修改当前用户密码-用户可以使用ALTER命令来修改自身密码，如下语句代表修"><a href="#1-使用ALTER-USER命令来修改当前用户密码-用户可以使用ALTER命令来修改自身密码，如下语句代表修" class="headerlink" title="1. 使用ALTER USER命令来修改当前用户密码 用户可以使用ALTER命令来修改自身密码，如下语句代表修"></a>1. 使用ALTER USER命令来修改当前用户密码 用户可以使用ALTER命令来修改自身密码，如下语句代表修</h5><h5 id="改当前登录用户的密码。基本语法如下："><a href="#改当前登录用户的密码。基本语法如下：" class="headerlink" title="改当前登录用户的密码。基本语法如下："></a>改当前登录用户的密码。基本语法如下：</h5><p><strong>2. 使用SET语句来修改当前用户密码</strong> 使用root用户登录MySQL后，可以使用SET语句来修改密码，具体<br>SQL语句如下：</p>
<h5 id="该语句会自动将密码加密后再赋给当前用户。"><a href="#该语句会自动将密码加密后再赋给当前用户。" class="headerlink" title="该语句会自动将密码加密后再赋给当前用户。"></a>该语句会自动将密码加密后再赋给当前用户。</h5><h3 id="1-6-修改其它用户密码"><a href="#1-6-修改其它用户密码" class="headerlink" title="1. 6 修改其它用户密码"></a>1. 6 修改其它用户密码</h3><h5 id="1-使用ALTER语句来修改普通用户的密码-可以使用ALTER-USER语句来修改普通用户的密码。基本语法形"><a href="#1-使用ALTER语句来修改普通用户的密码-可以使用ALTER-USER语句来修改普通用户的密码。基本语法形" class="headerlink" title="1. 使用ALTER语句来修改普通用户的密码 可以使用ALTER USER语句来修改普通用户的密码。基本语法形"></a>1. 使用ALTER语句来修改普通用户的密码 可以使用ALTER USER语句来修改普通用户的密码。基本语法形</h5><h5 id="式如下："><a href="#式如下：" class="headerlink" title="式如下："></a>式如下：</h5><p><strong>2. 使用SET命令来修改普通用户的密码</strong> 使用root用户登录到MySQL服务器后，可以使用SET语句来修改普<br>通用户的密码。SET语句的代码如下：</p>
<h5 id="3-使用UPDATE语句修改普通用户的密码（不推荐）"><a href="#3-使用UPDATE语句修改普通用户的密码（不推荐）" class="headerlink" title="3. 使用UPDATE语句修改普通用户的密码（不推荐）"></a>3. 使用UPDATE语句修改普通用户的密码（不推荐）</h5><h3 id="1-7-MySQL-8-密码管理-了解"><a href="#1-7-MySQL-8-密码管理-了解" class="headerlink" title="1. 7 MySQL 8 密码管理(了解)"></a>1. 7 MySQL 8 密码管理(了解)</h3><h4 id="1-密码过期策略"><a href="#1-密码过期策略" class="headerlink" title="1. 密码过期策略"></a>1. 密码过期策略</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在MySQL中，数据库管理员可以手动设置账号密码过期，也可以建立一个自动密码过期策略。</span><br><span class="line">过期策略可以是全局的，也可以为每个账号设置单独的过期策略。</span><br></pre></td></tr></table></figure>

<h5 id="练习："><a href="#练习：" class="headerlink" title="练习："></a>练习：</h5><h5 id="方式①：使用SQL语句更改该变量的值并持久化"><a href="#方式①：使用SQL语句更改该变量的值并持久化" class="headerlink" title="方式①：使用SQL语句更改该变量的值并持久化"></a>方式①：使用SQL语句更改该变量的值并持久化</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">方式②：配置文件my.cnf中进行维护</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 修改当前用户的密码：（MySQL5.7测试有效）</span><br><span class="line">SET PASSWORD = PASSWORD(&#x27;123456&#x27;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER USER() IDENTIFIED BY &#x27;new_password&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD=&#x27;new_password&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER user [IDENTIFIED BY &#x27;新密码&#x27;]</span><br><span class="line">[,user[IDENTIFIED BY &#x27;新密码&#x27;]]...;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD FOR &#x27;username&#x27;@&#x27;hostname&#x27;=&#x27;new_password&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE MySQL.user SET authentication_string=PASSWORD(&quot;123456&quot;)</span><br><span class="line">WHERE User = &quot;username&quot; AND Host = &quot;hostname&quot;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER user PASSWORD EXPIRE;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PERSIST default_password_lifetime = 180 ; # 建立全局策略，设置密码每隔 180 天过期</span><br></pre></td></tr></table></figure>

<h5 id="手动设置指定时间过期方式-2-：单独设置"><a href="#手动设置指定时间过期方式-2-：单独设置" class="headerlink" title="手动设置指定时间过期方式 2 ：单独设置"></a>手动设置指定时间过期方式 2 ：单独设置</h5><h5 id="每个账号既可延用全局密码过期策略，也可单独设置策略。在CREATE-USER和ALTER-USER语句上加"><a href="#每个账号既可延用全局密码过期策略，也可单独设置策略。在CREATE-USER和ALTER-USER语句上加" class="headerlink" title="每个账号既可延用全局密码过期策略，也可单独设置策略。在CREATE USER和ALTER USER语句上加"></a>每个账号既可延用全局密码过期策略，也可单独设置策略。在CREATE USER和ALTER USER语句上加</h5><h5 id="入PASSWORD-EXPIRE选项可实现单独设置策略。下面是一些语句示例。"><a href="#入PASSWORD-EXPIRE选项可实现单独设置策略。下面是一些语句示例。" class="headerlink" title="入PASSWORD EXPIRE选项可实现单独设置策略。下面是一些语句示例。"></a>入PASSWORD EXPIRE选项可实现单独设置策略。下面是一些语句示例。</h5><h4 id="2-密码重用策略"><a href="#2-密码重用策略" class="headerlink" title="2. 密码重用策略"></a>2. 密码重用策略</h4><h5 id="手动设置密码重用方式-1-：全局"><a href="#手动设置密码重用方式-1-：全局" class="headerlink" title="手动设置密码重用方式 1 ：全局"></a>手动设置密码重用方式 1 ：全局</h5><h5 id="方式①：使用SQL"><a href="#方式①：使用SQL" class="headerlink" title="方式①：使用SQL"></a>方式①：使用SQL</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">方式②：my.cnf配置文件</span><br></pre></td></tr></table></figure>

<h5 id="手动设置密码重用方式-2-：单独设置"><a href="#手动设置密码重用方式-2-：单独设置" class="headerlink" title="手动设置密码重用方式 2 ：单独设置"></a>手动设置密码重用方式 2 ：单独设置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">default_password_lifetime=180 #建立全局策略，设置密码每隔 180 天过期</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#设置kangshifu账号密码每 90 天过期：</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE INTERVAL 90 DAY;</span><br><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE INTERVAL 90 DAY;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#设置密码永不过期：</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE NEVER;</span><br><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE NEVER;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#延用全局密码过期策略：</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE DEFAULT;</span><br><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD EXPIRE DEFAULT;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PERSIST password_history = 6 ; #设置不能选择最近使用过的 6 个密码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PERSIST password_reuse_interval = 365 ; #设置不能选择最近一年内的密码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">password_history= 6</span><br><span class="line">password_reuse_interval= 365</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#不能使用最近 5 个密码：</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD HISTORY 5 ;</span><br><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD HISTORY 5 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#不能使用最近 365 天内的密码：</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD REUSE INTERVAL 365 DAY;</span><br><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27; PASSWORD REUSE INTERVAL 365 DAY;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#既不能使用最近 5 个密码，也不能使用 365 天内的密码</span><br><span class="line">CREATE USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27;</span><br><span class="line">PASSWORD HISTORY 5</span><br><span class="line">PASSWORD REUSE INTERVAL 365 DAY;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;kangshifu&#x27;@&#x27;localhost&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="2-权限管理"><a href="#2-权限管理" class="headerlink" title="2. 权限管理"></a>2. 权限管理</h2><h3 id="2-1-权限列表"><a href="#2-1-权限列表" class="headerlink" title="2. 1 权限列表"></a>2. 1 权限列表</h3><p>MySQL到底都有哪些权限呢？</p>
<h5 id="（-1-）CREATE和DROP权限，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将"><a href="#（-1-）CREATE和DROP权限，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将" class="headerlink" title="（ 1 ）CREATE和DROP权限，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将"></a>（ 1 ）CREATE和DROP权限，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将</h5><p>MySQL数据库中的DROP权限授予某用户，用户就可以删除MySQL访问权限保存的数据库。 （ 2 ）<br>SELECT、INSERT、UPDATE和DELETE权限允许在一个数据库现有的表上实施操作。 （ 3 ）SELECT权限<br>只有在它们真正从一个表中检索行时才被用到。 （ 4 ）INDEX权限允许创建或删除索引，INDEX适用于已<br>有的表。如果具有某个表的CREATE权限，就可以在CREATE TABLE语句中包括索引定义。 （ 5 ）ALTER权<br>限可以使用ALTER TABLE来更改表的结构和重新命名表。 （ 6 ）CREATE ROUTINE权限用来创建保存的<br>程序（函数和程序），ALTER ROUTINE权限用来更改和删除保存的程序，EXECUTE权限用来执行保存的<br>程序。 （ 7 ）GRANT权限允许授权给其他用户，可用于数据库、表和保存的程序。 （ 8 ）FILE权限使用<br>户可以使用LOAD DATA INFILE和SELECT … INTO OUTFILE语句读或写服务器上的文件，任何被授予FILE权<br>限的用户都能读或写MySQL服务器上的任何文件（说明用户可以读任何数据库目录下的文件，因为服务<br>器可以访问这些文件）。</p>
<h3 id="2-2-授予权限的原则"><a href="#2-2-授予权限的原则" class="headerlink" title="2. 2 授予权限的原则"></a>2. 2 授予权限的原则</h3><h5 id="权限控制主要是出于安全因素，因此需要遵循以下几个经验原则："><a href="#权限控制主要是出于安全因素，因此需要遵循以下几个经验原则：" class="headerlink" title="权限控制主要是出于安全因素，因此需要遵循以下几个经验原则："></a>权限控制主要是出于安全因素，因此需要遵循以下几个经验原则：</h5><p>1 、只授予能满足需要的最小权限，防止用户干坏事。比如用户只是需要查询，那就只给select权限就可<br>以了，不要给用户赋予update、insert或者delete权限。</p>
<p>2 、创建用户的时候限制用户的登录主机，一般是限制成指定IP或者内网IP段。</p>
<p>3 、为每个用户设置满足密码复杂度的密码。</p>
<p>4 、定期清理不需要的用户，回收权限或者删除用户。</p>
<h3 id="2-3-授予权限"><a href="#2-3-授予权限" class="headerlink" title="2. 3 授予权限"></a>2. 3 授予权限</h3><h5 id="给用户授权的方式有-2-种，分别是通过把角色赋予用户给用户授权和直接给用户授权。用户是数据库的"><a href="#给用户授权的方式有-2-种，分别是通过把角色赋予用户给用户授权和直接给用户授权。用户是数据库的" class="headerlink" title="给用户授权的方式有 2 种，分别是通过把角色赋予用户给用户授权和直接给用户授权。用户是数据库的"></a>给用户授权的方式有 2 种，分别是通过把角色赋予用户给用户授权和直接给用户授权。用户是数据库的</h5><h5 id="使用者，我们可以通过给用户授予访问数据库中资源的权限，来控制使用者对数据库的访问，消除安全"><a href="#使用者，我们可以通过给用户授予访问数据库中资源的权限，来控制使用者对数据库的访问，消除安全" class="headerlink" title="使用者，我们可以通过给用户授予访问数据库中资源的权限，来控制使用者对数据库的访问，消除安全"></a>使用者，我们可以通过给用户授予访问数据库中资源的权限，来控制使用者对数据库的访问，消除安全</h5><h5 id="隐患。"><a href="#隐患。" class="headerlink" title="隐患。"></a>隐患。</h5><h5 id="授权命令："><a href="#授权命令：" class="headerlink" title="授权命令："></a>授权命令：</h5><h5 id="该权限如果发现没有该用户，则会直接新建一个用户。"><a href="#该权限如果发现没有该用户，则会直接新建一个用户。" class="headerlink" title="该权限如果发现没有该用户，则会直接新建一个用户。"></a>该权限如果发现没有该用户，则会直接新建一个用户。</h5><h5 id="比如："><a href="#比如：" class="headerlink" title="比如："></a>比如：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">给li4用户用本地命令行方式，授予atguigudb这个库下的所有表的插删改查的权限。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PASSWORD HISTORY 5</span><br><span class="line">PASSWORD REUSE INTERVAL 365 DAY;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show privileges;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT 权限1,权限2,...权限n ON 数据库名称.表名称 TO 用户名@用户地址 [IDENTIFIED BY ‘密码口令’];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT,INSERT,DELETE,UPDATE ON atguigudb.* TO li4@localhost ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">授予通过网络方式登录的joe用户 ，对所有库所有表的全部权限，密码设为 123 。注意这里唯独不包</span><br><span class="line">括grant的权限</span><br></pre></td></tr></table></figure>

<h5 id="我们在开发应用的时候，经常会遇到一种需求，就是要根据用户的不同，对数据进行横向和纵向的"><a href="#我们在开发应用的时候，经常会遇到一种需求，就是要根据用户的不同，对数据进行横向和纵向的" class="headerlink" title="我们在开发应用的时候，经常会遇到一种需求，就是要根据用户的不同，对数据进行横向和纵向的"></a>我们在开发应用的时候，经常会遇到一种需求，就是要根据用户的不同，对数据进行横向和纵向的</h5><h5 id="分组。"><a href="#分组。" class="headerlink" title="分组。"></a>分组。</h5><h5 id="所谓横向的分组，就是指用户可以接触到的数据的范围，比如可以看到哪些表的数据；"><a href="#所谓横向的分组，就是指用户可以接触到的数据的范围，比如可以看到哪些表的数据；" class="headerlink" title="所谓横向的分组，就是指用户可以接触到的数据的范围，比如可以看到哪些表的数据；"></a>所谓横向的分组，就是指用户可以接触到的数据的范围，比如可以看到哪些表的数据；</h5><h5 id="所谓纵向的分组，就是指用户对接触到的数据能访问到什么程度，比如能看、能改，甚至是"><a href="#所谓纵向的分组，就是指用户对接触到的数据能访问到什么程度，比如能看、能改，甚至是" class="headerlink" title="所谓纵向的分组，就是指用户对接触到的数据能访问到什么程度，比如能看、能改，甚至是"></a>所谓纵向的分组，就是指用户对接触到的数据能访问到什么程度，比如能看、能改，甚至是</h5><h5 id="删除。"><a href="#删除。" class="headerlink" title="删除。"></a>删除。</h5><h3 id="2-4-查看权限"><a href="#2-4-查看权限" class="headerlink" title="2. 4 查看权限"></a>2. 4 查看权限</h3><h5 id="查看当前用户权限"><a href="#查看当前用户权限" class="headerlink" title="查看当前用户权限"></a>查看当前用户权限</h5><h5 id="查看某用户的全局权限"><a href="#查看某用户的全局权限" class="headerlink" title="查看某用户的全局权限"></a>查看某用户的全局权限</h5><h3 id="2-5-收回权限"><a href="#2-5-收回权限" class="headerlink" title="2. 5 收回权限"></a>2. 5 收回权限</h3><h5 id="收回权限就是取消已经赋予用户的某些权限。-收回用户不必要的权限可以在一定程度上保证系统的安全"><a href="#收回权限就是取消已经赋予用户的某些权限。-收回用户不必要的权限可以在一定程度上保证系统的安全" class="headerlink" title="收回权限就是取消已经赋予用户的某些权限。 收回用户不必要的权限可以在一定程度上保证系统的安全"></a>收回权限就是取消已经赋予用户的某些权限。 收回用户不必要的权限可以在一定程度上保证系统的安全</h5><p><strong>性。</strong> MySQL中使用REVOKE语句取消用户的某些权限。使用REVOKE收回权限之后，用户账户的记录将从<br>db、host、tables_priv和columns_priv表中删除，但是用户账户记录仍然在user表中保存（删除user表中<br>的账户记录使用DROP USER语句）。</p>
<p><strong>注意：在将用户账户从user表删除之前，应该收回相应用户的所有权限。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">收回权限命令</span><br></pre></td></tr></table></figure>

<h5 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h5><h5 id="注意：须用户重新登录后才能生效"><a href="#注意：须用户重新登录后才能生效" class="headerlink" title="注意：须用户重新登录后才能生效"></a>注意：须用户重新登录后才能生效</h5><h2 id="3-权限表"><a href="#3-权限表" class="headerlink" title="3. 权限表"></a>3. 权限表</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO joe@&#x27;%&#x27; IDENTIFIED BY &#x27;123&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS;</span><br><span class="line"># 或</span><br><span class="line">SHOW GRANTS FOR CURRENT_USER;</span><br><span class="line"># 或</span><br><span class="line">SHOW GRANTS FOR CURRENT_USER();</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR &#x27;user&#x27;@&#x27;主机地址&#x27; ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE 权限1,权限2,...权限n ON 数据库名称.表名称 FROM 用户名@用户地址;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#收回全库全表的所有权限</span><br><span class="line">REVOKE ALL PRIVILEGES ON *.* FROM joe@&#x27;%&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#收回mysql库下的所有表的插删改查权限</span><br><span class="line">REVOKE SELECT,INSERT,UPDATE,DELETE ON mysql.* FROM joe@localhost;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-user表"><a href="#3-1-user表" class="headerlink" title="3.1 user表"></a>3.1 user表</h3><p>user表是MySQL中最重要的一个权限表，记录用户账号和权限信息，有 49 个字段。如下图：</p>
<h5 id="这些字段可以分成-4-类，分别是范围列（或用户列）、权限列、安全列和资源控制列。"><a href="#这些字段可以分成-4-类，分别是范围列（或用户列）、权限列、安全列和资源控制列。" class="headerlink" title="这些字段可以分成 4 类，分别是范围列（或用户列）、权限列、安全列和资源控制列。"></a>这些字段可以分成 4 类，分别是范围列（或用户列）、权限列、安全列和资源控制列。</h5><h5 id="1-范围列（或用户列）"><a href="#1-范围列（或用户列）" class="headerlink" title="1 .范围列（或用户列）"></a>1 .范围列（或用户列）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">host ： 表示连接类型</span><br><span class="line">% 表示所有远程通过 TCP方式的连接</span><br><span class="line">IP 地址 如 (192.168.1.2、127.0.0.1) 通过制定ip地址进行的TCP方式的连接</span><br><span class="line">机器名 通过制定网络中的机器名进行的TCP方式的连接</span><br><span class="line">::1 IPv6的本地ip地址，等同于IPv4的 127.0.0.</span><br><span class="line">localhost 本地方式通过命令行方式的连接 ，比如mysql -u xxx -p xxx 方式的连接。</span><br><span class="line">user ： 表示用户名，同一用户通过不同方式链接的权限是不一样的。</span><br><span class="line">password ： 密码</span><br><span class="line">所有密码串通过 password(明文字符串) 生成的密文字符串。MySQL 8.0 在用户管理方面增加了</span><br><span class="line">角色管理，默认的密码加密方式也做了调整，由之前的 SHA1 改为了 SHA2，不可逆 。同时</span><br><span class="line">加上 MySQL 5.7 的禁用用户和用户过期的功能，MySQL 在用户管理方面的功能和安全性都较之</span><br><span class="line">前版本大大的增强了。</span><br><span class="line">mysql 5.7 及之后版本的密码保存到 authentication_string 字段中不再使用password 字</span><br><span class="line">段。</span><br></pre></td></tr></table></figure>

<p><strong>2. 权限列</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Grant_priv字段</span><br><span class="line">表示是否拥有GRANT权限</span><br><span class="line">Shutdown_priv字段</span><br><span class="line">表示是否拥有停止MySQL服务的权限</span><br><span class="line">Super_priv字段</span><br><span class="line">表示是否拥有超级权限</span><br><span class="line">Execute_priv字段</span><br><span class="line">表示是否拥有EXECUTE权限。拥有EXECUTE权限，可以执行存储过程和函数。</span><br><span class="line">Select_priv , Insert_priv等</span><br><span class="line">为该用户所拥有的权限。</span><br></pre></td></tr></table></figure>

<p><strong>3. 安全列</strong> 安全列只有 6 个字段，其中两个是ssl相关的（ssl_type、ssl_cipher），用于加密；两个是x<br>相关的（x509_issuer、x509_subject），用于标识用户；另外两个Plugin字段用于验证用户身份的插件，<br>该字段不能为空。如果该字段为空，服务器就使用内建授权验证机制验证用户身份。</p>
<p><strong>4. 资源控制列</strong> 资源控制列的字段用来限制用户使用的资源，包含 4 个字段，分别为：</p>
<p>①max_questions，用户每小时允许执行的查询操作次数； ②max_updates，用户每小时允许执行的更新<br>操作次数； ③max_connections，用户每小时允许执行的连接操作次数； ④max_user_connections，用户<br>允许同时建立的连接次数。</p>
<p>查看字段：</p>
<h5 id="查看用户-以列的方式显示数据："><a href="#查看用户-以列的方式显示数据：" class="headerlink" title="查看用户, 以列的方式显示数据："></a>查看用户, 以列的方式显示数据：</h5><h5 id="查询特定字段："><a href="#查询特定字段：" class="headerlink" title="查询特定字段："></a>查询特定字段：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESC mysql.user;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM mysql.user \G;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT host,user,authentication_string,select_priv,insert_priv,drop_priv</span><br><span class="line">FROM mysql.user;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-db表"><a href="#3-2-db表" class="headerlink" title="3.2 db表"></a>3.2 db表</h3><p>使用DESCRIBE查看db表的基本结构：</p>
<p><strong>1. 用户列</strong> db表用户列有 3 个字段，分别是Host、User、Db。这 3 个字段分别表示主机名、用户名和数据库<br>名。表示从某个主机连接某个用户对某个数据库的操作权限，这 3 个字段的组合构成了db表的主键。</p>
<p><strong>2. 权限列</strong></p>
<p>Create_routine_priv和Alter_routine_priv这两个字段决定用户是否具有创建和修改存储过程的权限。</p>
<h3 id="3-3-tables-priv表和columns-priv表"><a href="#3-3-tables-priv表和columns-priv表" class="headerlink" title="3.3 tables_priv表和columns_priv表"></a>3.3 tables_priv表和columns_priv表</h3><p>tables_priv表用来对表设置操作权限，columns_priv表用来对表的某一列设置权限。tables_priv表和<br>columns_priv表的结构分别如图：</p>
<p>tables_priv表有 8 个字段，分别是Host、Db、User、Table_name、Grantor、Timestamp、Table_priv和<br>Column_priv，各个字段说明如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Host、Db、User和Table_name四个字段分别表示主机名、数据库名、用户名和表名。</span><br><span class="line">Grantor表示修改该记录的用户。</span><br><span class="line">Timestamp表示修改该记录的时间。</span><br><span class="line">Table_priv表示对象的操作权限。包括Select、Insert、Update、Delete、Create、Drop、Grant、</span><br><span class="line">References、Index和Alter。</span><br><span class="line">Column_priv字段表示对表中的列的操作权限，包括Select、Insert、Update和References。</span><br></pre></td></tr></table></figure>

<h3 id="3-4-procs-priv表"><a href="#3-4-procs-priv表" class="headerlink" title="3.4 procs_priv表"></a>3.4 procs_priv表</h3><p>procs_priv表可以对存储过程和存储函数设置操作权限，表结构如图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESCRIBE mysql.db;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc mysql.tables_priv;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc mysql.columns_priv;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc mysql.procs_priv;</span><br></pre></td></tr></table></figure>

<h2 id="4-访问控制-了解"><a href="#4-访问控制-了解" class="headerlink" title="4. 访问控制(了解)"></a>4. 访问控制(了解)</h2><h3 id="4-1-连接核实阶段"><a href="#4-1-连接核实阶段" class="headerlink" title="4. 1 连接核实阶段"></a>4. 1 连接核实阶段</h3><p>当用户试图连接MySQL服务器时，服务器基于用户的身份以及用户是否能提供正确的密码验证身份来确<br>定接受或者拒绝连接。即客户端用户会在连接请求中提供用户名、主机地址、用户密码，MySQL服务器<br>接收到用户请求后，会 <strong>使用user表中的host、user和authentication_string这 3 个字段匹配客户端提供信<br>息</strong> 。</p>
<p>服务器只有在user表记录的Host和User字段匹配客户端主机名和用户名，并且提供正确的密码时才接受<br>连接。 <strong>如果连接核实没有通过，服务器就完全拒绝访问</strong> ； <strong>否则，服务器接受连接，然后进入阶段 2 等待<br>用户请求。</strong></p>
<h3 id="4-2-请求核实阶段"><a href="#4-2-请求核实阶段" class="headerlink" title="4. 2 请求核实阶段"></a>4. 2 请求核实阶段</h3><h5 id="一旦建立了连接，服务器就进入了访问控制的阶段-2-，也就是请求核实阶段。对此连接上进来的每个请"><a href="#一旦建立了连接，服务器就进入了访问控制的阶段-2-，也就是请求核实阶段。对此连接上进来的每个请" class="headerlink" title="一旦建立了连接，服务器就进入了访问控制的阶段 2 ，也就是请求核实阶段。对此连接上进来的每个请"></a>一旦建立了连接，服务器就进入了访问控制的阶段 2 ，也就是请求核实阶段。对此连接上进来的每个请</h5><h5 id="求，服务器检查该请求要执行什么操作、是否有足够的权限来执行它，这正是需要授权表中的权限列发"><a href="#求，服务器检查该请求要执行什么操作、是否有足够的权限来执行它，这正是需要授权表中的权限列发" class="headerlink" title="求，服务器检查该请求要执行什么操作、是否有足够的权限来执行它，这正是需要授权表中的权限列发"></a>求，服务器检查该请求要执行什么操作、是否有足够的权限来执行它，这正是需要授权表中的权限列发</h5><p>挥作用的地方。这些权限可以来自user、db、table_priv和column_priv表。</p>
<p>确认权限时，MySQL首先检查user表，如果指定的权限没有在user表中被授予，那么MySQL就会继续检<br>查db表，db表是下一安全层级，其中的权限限定于数据库层级，在该层级的SELECT权限允许用户查看指<br>定数据库的所有表中的数据；如果在该层级没有找到限定的权限，则MySQL继续检查tables_priv表以<br>及columns_priv表，如果所有权限表都检查完毕，但还是没有找到允许的权限操作，MySQL将返回错<br>误信息，用户请求的操作不能执行，操作失败。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">提示： MySQL通过向下层级的顺序（从user表到columns_priv表）检查权限表，但并不是所有的权</span><br><span class="line">限都要执行该过程。例如，一个用户登录到MySQL服务器之后只执行对MySQL的管理操作，此时只</span><br><span class="line">涉及管理权限，因此MySQL只检查user表。另外，如果请求的权限操作不被允许，MySQL也不会继</span><br><span class="line">续检查下一层级的表。</span><br></pre></td></tr></table></figure>

<h2 id="5-角色管理"><a href="#5-角色管理" class="headerlink" title="5. 角色管理"></a>5. 角色管理</h2><h3 id="5-1-角色的理解"><a href="#5-1-角色的理解" class="headerlink" title="5. 1 角色的理解"></a>5. 1 角色的理解</h3><h5 id="引入角色的目的是方便管理拥有相同权限的用户。-恰当的权限设定，可以确保数据的安全性，这是至关"><a href="#引入角色的目的是方便管理拥有相同权限的用户。-恰当的权限设定，可以确保数据的安全性，这是至关" class="headerlink" title="引入角色的目的是方便管理拥有相同权限的用户。 恰当的权限设定，可以确保数据的安全性，这是至关"></a>引入角色的目的是方便管理拥有相同权限的用户。 恰当的权限设定，可以确保数据的安全性，这是至关</h5><h5 id="重要的-。"><a href="#重要的-。" class="headerlink" title="重要的 。"></a>重要的 。</h5><h3 id="5-2-创建角色"><a href="#5-2-创建角色" class="headerlink" title="5. 2 创建角色"></a>5. 2 创建角色</h3><h5 id="创建角色使用CREATE-ROLE语句，语法如下："><a href="#创建角色使用CREATE-ROLE语句，语法如下：" class="headerlink" title="创建角色使用CREATE ROLE语句，语法如下："></a>创建角色使用CREATE ROLE语句，语法如下：</h5><p>角色名称的命名规则和用户名类似。如果host_name省略，默认为%，role_name不可省略，不可为<br>空。</p>
<p>练习：我们现在需要创建一个经理的角色，就可以用下面的代码：</p>
<h3 id="5-3-给角色赋予权限"><a href="#5-3-给角色赋予权限" class="headerlink" title="5. 3 给角色赋予权限"></a>5. 3 给角色赋予权限</h3><h5 id="创建角色之后，默认这个角色是没有任何权限的，我们需要给角色授权。给角色授权的语法结构是："><a href="#创建角色之后，默认这个角色是没有任何权限的，我们需要给角色授权。给角色授权的语法结构是：" class="headerlink" title="创建角色之后，默认这个角色是没有任何权限的，我们需要给角色授权。给角色授权的语法结构是："></a>创建角色之后，默认这个角色是没有任何权限的，我们需要给角色授权。给角色授权的语法结构是：</h5><p>上述语句中privileges代表权限的名称，多个权限以逗号隔开。可使用SHOW语句查询权限名称，图11-<br>列出了部分权限列表。</p>
<h5 id="练习-1-：我们现在想给经理角色授予商品信息表、盘点表和应付账款表的只读权限，就可以用下面的代码"><a href="#练习-1-：我们现在想给经理角色授予商品信息表、盘点表和应付账款表的只读权限，就可以用下面的代码" class="headerlink" title="练习 1 ：我们现在想给经理角色授予商品信息表、盘点表和应付账款表的只读权限，就可以用下面的代码"></a>练习 1 ：我们现在想给经理角色授予商品信息表、盘点表和应付账款表的只读权限，就可以用下面的代码</h5><h5 id="来实现："><a href="#来实现：" class="headerlink" title="来实现："></a>来实现：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE &#x27;role_name&#x27;[@&#x27;host_name&#x27;] [,&#x27;role_name&#x27;[@&#x27;host_name&#x27;]]...</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE &#x27;manager&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT privileges ON table_name TO &#x27;role_name&#x27;[@&#x27;host_name&#x27;];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW PRIVILEGES\G;</span><br></pre></td></tr></table></figure>

<h3 id="5-4-查看角色的权限"><a href="#5-4-查看角色的权限" class="headerlink" title="5. 4 查看角色的权限"></a>5. 4 查看角色的权限</h3><h5 id="赋予角色权限之后，我们可以通过-SHOW-GRANTS-语句，来查看权限是否创建成功了："><a href="#赋予角色权限之后，我们可以通过-SHOW-GRANTS-语句，来查看权限是否创建成功了：" class="headerlink" title="赋予角色权限之后，我们可以通过 SHOW GRANTS 语句，来查看权限是否创建成功了："></a>赋予角色权限之后，我们可以通过 SHOW GRANTS 语句，来查看权限是否创建成功了：</h5><h5 id="只要你创建了一个角色，系统就会自动给你一个“USAGE”权限，意思是连接登录数据库的权限。代码的"><a href="#只要你创建了一个角色，系统就会自动给你一个“USAGE”权限，意思是连接登录数据库的权限。代码的" class="headerlink" title="只要你创建了一个角色，系统就会自动给你一个“USAGE”权限，意思是连接登录数据库的权限。代码的"></a>只要你创建了一个角色，系统就会自动给你一个“USAGE”权限，意思是连接登录数据库的权限。代码的</h5><p>最后三行代表了我们给角色“manager”赋予的权限，也就是对商品信息表、盘点表和应付账款表的只读权<br>限。</p>
<p>结果显示，库管角色拥有商品信息表的只读权限和盘点表的增删改查权限。</p>
<h3 id="5-5-回收角色的权限"><a href="#5-5-回收角色的权限" class="headerlink" title="5. 5 回收角色的权限"></a>5. 5 回收角色的权限</h3><h5 id="角色授权后，可以对角色的权限进行维护，对权限进行添加或撤销。添加权限使用GRANT语句，与角色"><a href="#角色授权后，可以对角色的权限进行维护，对权限进行添加或撤销。添加权限使用GRANT语句，与角色" class="headerlink" title="角色授权后，可以对角色的权限进行维护，对权限进行添加或撤销。添加权限使用GRANT语句，与角色"></a>角色授权后，可以对角色的权限进行维护，对权限进行添加或撤销。添加权限使用GRANT语句，与角色</h5><h5 id="授权相同。撤销角色或角色权限使用REVOKE语句。"><a href="#授权相同。撤销角色或角色权限使用REVOKE语句。" class="headerlink" title="授权相同。撤销角色或角色权限使用REVOKE语句。"></a>授权相同。撤销角色或角色权限使用REVOKE语句。</h5><h5 id="修改了角色的权限，会影响拥有该角色的账户的权限。"><a href="#修改了角色的权限，会影响拥有该角色的账户的权限。" class="headerlink" title="修改了角色的权限，会影响拥有该角色的账户的权限。"></a>修改了角色的权限，会影响拥有该角色的账户的权限。</h5><h5 id="撤销角色权限的SQL语法如下："><a href="#撤销角色权限的SQL语法如下：" class="headerlink" title="撤销角色权限的SQL语法如下："></a>撤销角色权限的SQL语法如下：</h5><p>练习 1 ：撤销school_write角色的权限。 （ 1 ）使用如下语句撤销school_write角色的权限。</p>
<p>（ 2 ）撤销后使用SHOW语句查看school_write对应的权限，语句如下。</p>
<h3 id="5-6-删除角色"><a href="#5-6-删除角色" class="headerlink" title="5. 6 删除角色"></a>5. 6 删除角色</h3><h5 id="当我们需要对业务重新整合的时候，可能就需要对之前创建的角色进行清理，删除一些不会再使用的角"><a href="#当我们需要对业务重新整合的时候，可能就需要对之前创建的角色进行清理，删除一些不会再使用的角" class="headerlink" title="当我们需要对业务重新整合的时候，可能就需要对之前创建的角色进行清理，删除一些不会再使用的角"></a>当我们需要对业务重新整合的时候，可能就需要对之前创建的角色进行清理，删除一些不会再使用的角</h5><h5 id="色。删除角色的操作很简单，你只要掌握语法结构就行了。"><a href="#色。删除角色的操作很简单，你只要掌握语法结构就行了。" class="headerlink" title="色。删除角色的操作很简单，你只要掌握语法结构就行了。"></a>色。删除角色的操作很简单，你只要掌握语法结构就行了。</h5><h5 id="注意，如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限。"><a href="#注意，如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限。" class="headerlink" title="注意，如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限。"></a>注意，如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限。</h5><p>练习：执行如下SQL删除角色school_read。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT ON demo.settlement TO &#x27;manager&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT ON demo.goodsmaster TO &#x27;manager&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT ON demo.invcount TO &#x27;manager&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW GRANTS FOR &#x27;manager&#x27;;</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| Grants for manager@% |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO `manager`@`%` |</span><br><span class="line">| GRANT SELECT ON `demo`.`goodsmaster` TO `manager`@`%` |</span><br><span class="line">| GRANT SELECT ON `demo`.`invcount` TO `manager`@`%` |</span><br><span class="line">| GRANT SELECT ON `demo`.`settlement` TO `manager`@`%` |</span><br><span class="line">+-------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE privileges ON tablename FROM &#x27;rolename&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE INSERT, UPDATE, DELETE ON school.* FROM &#x27;school_write&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR &#x27;school_write&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP ROLE role [,role2]...</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP ROLE &#x27;school_read&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="5-7-给用户赋予角色"><a href="#5-7-给用户赋予角色" class="headerlink" title="5. 7 给用户赋予角色"></a>5. 7 给用户赋予角色</h3><h5 id="角色创建并授权后，要赋给用户并处于激活状态才能发挥作用。给用户添加角色可使用GRANT语句，语"><a href="#角色创建并授权后，要赋给用户并处于激活状态才能发挥作用。给用户添加角色可使用GRANT语句，语" class="headerlink" title="角色创建并授权后，要赋给用户并处于激活状态才能发挥作用。给用户添加角色可使用GRANT语句，语"></a>角色创建并授权后，要赋给用户并处于激活状态才能发挥作用。给用户添加角色可使用GRANT语句，语</h5><h5 id="法形式如下："><a href="#法形式如下：" class="headerlink" title="法形式如下："></a>法形式如下：</h5><p>在上述语句中，role代表角色，user代表用户。可将多个角色同时赋予多个用户，用逗号隔开即可。</p>
<p>练习：给kangshifu用户添加角色school_read权限。 （ 1 ）使用GRANT语句给kangshifu添加school_read权<br>限，SQL语句如下。</p>
<h5 id="（-2-）添加完成后使用SHOW语句查看是否添加成功，SQL语句如下。"><a href="#（-2-）添加完成后使用SHOW语句查看是否添加成功，SQL语句如下。" class="headerlink" title="（ 2 ）添加完成后使用SHOW语句查看是否添加成功，SQL语句如下。"></a>（ 2 ）添加完成后使用SHOW语句查看是否添加成功，SQL语句如下。</h5><p>（ 3 ）使用kangshifu用户登录，然后查询当前角色，如果角色未激活，结果将显示NONE。SQL语句如<br>下。</p>
<h3 id="5-8-激活角色"><a href="#5-8-激活角色" class="headerlink" title="5. 8 激活角色"></a>5. 8 激活角色</h3><p><strong>方式 1 ：使用set default role 命令激活角色</strong></p>
<p>举例：</p>
<h5 id="举例：使用SET-DEFAULT-ROLE为下面-4-个用户默认激活所有已拥有的角色如下："><a href="#举例：使用SET-DEFAULT-ROLE为下面-4-个用户默认激活所有已拥有的角色如下：" class="headerlink" title="举例：使用SET DEFAULT ROLE为下面 4 个用户默认激活所有已拥有的角色如下："></a>举例：使用SET DEFAULT ROLE为下面 4 个用户默认激活所有已拥有的角色如下：</h5><p><strong>方式 2 ：将activate_all_roles_on_login设置为ON</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认情况：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT role [,role2,...] TO user [,user2,...];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT &#x27;school_read&#x27; TO &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CURRENT_ROLE();</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET DEFAULT ROLE ALL TO &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SET DEFAULT ROLE ALL TO</span><br><span class="line">&#x27;dev1&#x27;@&#x27;localhost&#x27;,</span><br><span class="line">&#x27;read_user1&#x27;@&#x27;localhost&#x27;,</span><br><span class="line">&#x27;read_user2&#x27;@&#x27;localhost&#x27;,</span><br><span class="line">&#x27;rw_user1&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &#x27;activate_all_roles_on_login&#x27;;</span><br><span class="line">+-----------------------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+-----------------------------+-------+</span><br><span class="line">| activate_all_roles_on_login | OFF |</span><br><span class="line">+-----------------------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="设置："><a href="#设置：" class="headerlink" title="设置："></a>设置：</h5><h5 id="这条-SQL-语句的意思是，对所有角色永久激活。运行这条语句之后，用户才真正拥有了赋予角色的所有"><a href="#这条-SQL-语句的意思是，对所有角色永久激活。运行这条语句之后，用户才真正拥有了赋予角色的所有" class="headerlink" title="这条 SQL 语句的意思是，对所有角色永久激活。运行这条语句之后，用户才真正拥有了赋予角色的所有"></a>这条 SQL 语句的意思是，对所有角色永久激活。运行这条语句之后，用户才真正拥有了赋予角色的所有</h5><h5 id="权限。"><a href="#权限。" class="headerlink" title="权限。"></a>权限。</h5><h3 id="5-9-撤销用户的角色"><a href="#5-9-撤销用户的角色" class="headerlink" title="5.9 撤销用户的角色"></a>5.9 撤销用户的角色</h3><h5 id="撤销用户角色的SQL语法如下："><a href="#撤销用户角色的SQL语法如下：" class="headerlink" title="撤销用户角色的SQL语法如下："></a>撤销用户角色的SQL语法如下：</h5><p>练习：撤销kangshifu用户的school_read角色。 （ 1 ）撤销的SQL语句如下</p>
<p>（ 2 ）撤销后，执行如下查询语句，查看kangshifu用户的角色信息</p>
<p>执行发现，用户kangshifu之前的school_read角色已被撤销。</p>
<h3 id="5-10-设置强制角色-mandatory-role"><a href="#5-10-设置强制角色-mandatory-role" class="headerlink" title="5.10 设置强制角色(mandatory role)"></a>5.10 设置强制角色(mandatory role)</h3><h5 id="方式-1-：服务启动前设置"><a href="#方式-1-：服务启动前设置" class="headerlink" title="方式 1 ：服务启动前设置"></a>方式 1 ：服务启动前设置</h5><h5 id="方式-2-：运行时设置"><a href="#方式-2-：运行时设置" class="headerlink" title="方式 2 ：运行时设置"></a>方式 2 ：运行时设置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET GLOBAL activate_all_roles_on_login=ON;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE role FROM user;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE &#x27;school_read&#x27; FROM &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR &#x27;kangshifu&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">mandatory_roles=&#x27;role1,role2@localhost,r3@%.atguigu.com&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET PERSIST mandatory_roles = &#x27;role1,role2@localhost,r3@%.example.com&#x27;;  #系统重启后仍然</span><br><span class="line">有效</span><br><span class="line">SET GLOBAL mandatory_roles = &#x27;role1,role2@localhost,r3@%.example.com&#x27;;  #系统重启后失效</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Mysql/" rel="tag"># Mysql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/11/09/%E6%95%B0%E6%8D%AE%E5%BA%93/Linux%E4%B8%8BMySQL%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="prev" title="Linux下MySQL的安装与使用">
      <i class="fa fa-chevron-left"></i> Linux下MySQL的安装与使用
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/12/08/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84/" rel="next" title="Mysql逻辑架构">
      Mysql逻辑架构 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="nav-number">1.</span> <span class="nav-text">用户与权限管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="nav-number">1.1.</span> <span class="nav-text">1. 用户管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E7%99%BB%E5%BD%95MySQL%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">1.2.</span> <span class="nav-text">1. 1 登录MySQL服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8B%E9%9D%A2%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%91%BD%E4%BB%A4%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9A"><span class="nav-number">1.2.0.0.1.</span> <span class="nav-text">下面详细介绍命令中的参数：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="nav-number">1.3.</span> <span class="nav-text">1. 2 创建用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#CREATE-USER%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%BD%A2%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.0.0.1.</span> <span class="nav-text">CREATE USER语句的基本语法形式如下：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7"><span class="nav-number">1.3.1.</span> <span class="nav-text">1. 3 修改用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%90%8D%EF%BC%9A"><span class="nav-number">1.3.1.0.1.</span> <span class="nav-text">修改用户名：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7"><span class="nav-number">1.3.2.</span> <span class="nav-text">1. 4 删除用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-1-%EF%BC%9A%E4%BD%BF%E7%94%A8DROP%E6%96%B9%E5%BC%8F%E5%88%A0%E9%99%A4%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.3.2.0.1.</span> <span class="nav-text">方式 1 ：使用DROP方式删除（推荐）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8DROP-USER%E8%AF%AD%E5%8F%A5%E6%9D%A5%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E6%97%B6%EF%BC%8C%E5%BF%85%E9%A1%BB%E7%94%A8%E4%BA%8EDROP-USER%E6%9D%83%E9%99%90%E3%80%82DROP-USER%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%BD%A2%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.2.0.2.</span> <span class="nav-text">使用DROP USER语句来删除用户时，必须用于DROP USER权限。DROP USER语句的基本语法形式如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B%EF%BC%9A"><span class="nav-number">1.3.2.0.3.</span> <span class="nav-text">举例：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-2-%EF%BC%9A%E4%BD%BF%E7%94%A8DELETE%E6%96%B9%E5%BC%8F%E5%88%A0%E9%99%A4"><span class="nav-number">1.3.2.0.4.</span> <span class="nav-text">方式 2 ：使用DELETE方式删除</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%AE%8CDELETE%E5%91%BD%E4%BB%A4%E5%90%8E%E8%A6%81%E4%BD%BF%E7%94%A8FLUSH%E5%91%BD%E4%BB%A4%E6%9D%A5%E4%BD%BF%E7%94%A8%E6%88%B7%E7%94%9F%E6%95%88%EF%BC%8C%E5%91%BD%E4%BB%A4%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.2.0.5.</span> <span class="nav-text">执行完DELETE命令后要使用FLUSH命令来使用户生效，命令如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B%EF%BC%9A-1"><span class="nav-number">1.3.2.0.6.</span> <span class="nav-text">举例：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-number">1.3.3.</span> <span class="nav-text">1. 5 设置当前用户密码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%97%A7%E7%9A%84%E5%86%99%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.3.0.1.</span> <span class="nav-text">旧的写法如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E9%87%8C%E4%BB%8B%E7%BB%8D%E6%8E%A8%E8%8D%90%E7%9A%84%E5%86%99%E6%B3%95%EF%BC%9A"><span class="nav-number">1.3.3.0.2.</span> <span class="nav-text">这里介绍推荐的写法：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8ALTER-USER%E5%91%BD%E4%BB%A4%E6%9D%A5%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81-%E7%94%A8%E6%88%B7%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8ALTER%E5%91%BD%E4%BB%A4%E6%9D%A5%E4%BF%AE%E6%94%B9%E8%87%AA%E8%BA%AB%E5%AF%86%E7%A0%81%EF%BC%8C%E5%A6%82%E4%B8%8B%E8%AF%AD%E5%8F%A5%E4%BB%A3%E8%A1%A8%E4%BF%AE"><span class="nav-number">1.3.3.0.3.</span> <span class="nav-text">1. 使用ALTER USER命令来修改当前用户密码 用户可以使用ALTER命令来修改自身密码，如下语句代表修</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%B9%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%E3%80%82%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.3.0.4.</span> <span class="nav-text">改当前登录用户的密码。基本语法如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%A5%E8%AF%AD%E5%8F%A5%E4%BC%9A%E8%87%AA%E5%8A%A8%E5%B0%86%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E5%90%8E%E5%86%8D%E8%B5%8B%E7%BB%99%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E3%80%82"><span class="nav-number">1.3.3.0.5.</span> <span class="nav-text">该语句会自动将密码加密后再赋给当前用户。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-%E4%BF%AE%E6%94%B9%E5%85%B6%E5%AE%83%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-number">1.3.4.</span> <span class="nav-text">1. 6 修改其它用户密码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8ALTER%E8%AF%AD%E5%8F%A5%E6%9D%A5%E4%BF%AE%E6%94%B9%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81-%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8ALTER-USER%E8%AF%AD%E5%8F%A5%E6%9D%A5%E4%BF%AE%E6%94%B9%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%E3%80%82%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%BD%A2"><span class="nav-number">1.3.4.0.1.</span> <span class="nav-text">1. 使用ALTER语句来修改普通用户的密码 可以使用ALTER USER语句来修改普通用户的密码。基本语法形</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.3.4.0.2.</span> <span class="nav-text">式如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8UPDATE%E8%AF%AD%E5%8F%A5%E4%BF%AE%E6%94%B9%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.3.4.0.3.</span> <span class="nav-text">3. 使用UPDATE语句修改普通用户的密码（不推荐）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-MySQL-8-%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86-%E4%BA%86%E8%A7%A3"><span class="nav-number">1.3.5.</span> <span class="nav-text">1. 7 MySQL 8 密码管理(了解)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AF%86%E7%A0%81%E8%BF%87%E6%9C%9F%E7%AD%96%E7%95%A5"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">1. 密码过期策略</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A"><span class="nav-number">1.3.5.1.1.</span> <span class="nav-text">练习：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E2%91%A0%EF%BC%9A%E4%BD%BF%E7%94%A8SQL%E8%AF%AD%E5%8F%A5%E6%9B%B4%E6%94%B9%E8%AF%A5%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC%E5%B9%B6%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">1.3.5.1.2.</span> <span class="nav-text">方式①：使用SQL语句更改该变量的值并持久化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E8%BF%87%E6%9C%9F%E6%96%B9%E5%BC%8F-2-%EF%BC%9A%E5%8D%95%E7%8B%AC%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.3.5.1.3.</span> <span class="nav-text">手动设置指定时间过期方式 2 ：单独设置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AF%8F%E4%B8%AA%E8%B4%A6%E5%8F%B7%E6%97%A2%E5%8F%AF%E5%BB%B6%E7%94%A8%E5%85%A8%E5%B1%80%E5%AF%86%E7%A0%81%E8%BF%87%E6%9C%9F%E7%AD%96%E7%95%A5%EF%BC%8C%E4%B9%9F%E5%8F%AF%E5%8D%95%E7%8B%AC%E8%AE%BE%E7%BD%AE%E7%AD%96%E7%95%A5%E3%80%82%E5%9C%A8CREATE-USER%E5%92%8CALTER-USER%E8%AF%AD%E5%8F%A5%E4%B8%8A%E5%8A%A0"><span class="nav-number">1.3.5.1.4.</span> <span class="nav-text">每个账号既可延用全局密码过期策略，也可单独设置策略。在CREATE USER和ALTER USER语句上加</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A5PASSWORD-EXPIRE%E9%80%89%E9%A1%B9%E5%8F%AF%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%8B%AC%E8%AE%BE%E7%BD%AE%E7%AD%96%E7%95%A5%E3%80%82%E4%B8%8B%E9%9D%A2%E6%98%AF%E4%B8%80%E4%BA%9B%E8%AF%AD%E5%8F%A5%E7%A4%BA%E4%BE%8B%E3%80%82"><span class="nav-number">1.3.5.1.5.</span> <span class="nav-text">入PASSWORD EXPIRE选项可实现单独设置策略。下面是一些语句示例。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AF%86%E7%A0%81%E9%87%8D%E7%94%A8%E7%AD%96%E7%95%A5"><span class="nav-number">1.3.5.2.</span> <span class="nav-text">2. 密码重用策略</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81%E9%87%8D%E7%94%A8%E6%96%B9%E5%BC%8F-1-%EF%BC%9A%E5%85%A8%E5%B1%80"><span class="nav-number">1.3.5.2.1.</span> <span class="nav-text">手动设置密码重用方式 1 ：全局</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E2%91%A0%EF%BC%9A%E4%BD%BF%E7%94%A8SQL"><span class="nav-number">1.3.5.2.2.</span> <span class="nav-text">方式①：使用SQL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81%E9%87%8D%E7%94%A8%E6%96%B9%E5%BC%8F-2-%EF%BC%9A%E5%8D%95%E7%8B%AC%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.3.5.2.3.</span> <span class="nav-text">手动设置密码重用方式 2 ：单独设置</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="nav-number">1.4.</span> <span class="nav-text">2. 权限管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E6%9D%83%E9%99%90%E5%88%97%E8%A1%A8"><span class="nav-number">1.4.1.</span> <span class="nav-text">2. 1 权限列表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%88-1-%EF%BC%89CREATE%E5%92%8CDROP%E6%9D%83%E9%99%90%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8%EF%BC%8C%E6%88%96%E5%88%A0%E9%99%A4%EF%BC%88%E7%A7%BB%E6%8E%89%EF%BC%89%E5%B7%B2%E6%9C%89%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8%E3%80%82%E5%A6%82%E6%9E%9C%E5%B0%86"><span class="nav-number">1.4.1.0.1.</span> <span class="nav-text">（ 1 ）CREATE和DROP权限，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E6%8E%88%E4%BA%88%E6%9D%83%E9%99%90%E7%9A%84%E5%8E%9F%E5%88%99"><span class="nav-number">1.4.2.</span> <span class="nav-text">2. 2 授予权限的原则</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E4%B8%BB%E8%A6%81%E6%98%AF%E5%87%BA%E4%BA%8E%E5%AE%89%E5%85%A8%E5%9B%A0%E7%B4%A0%EF%BC%8C%E5%9B%A0%E6%AD%A4%E9%9C%80%E8%A6%81%E9%81%B5%E5%BE%AA%E4%BB%A5%E4%B8%8B%E5%87%A0%E4%B8%AA%E7%BB%8F%E9%AA%8C%E5%8E%9F%E5%88%99%EF%BC%9A"><span class="nav-number">1.4.2.0.1.</span> <span class="nav-text">权限控制主要是出于安全因素，因此需要遵循以下几个经验原则：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E6%8E%88%E4%BA%88%E6%9D%83%E9%99%90"><span class="nav-number">1.4.3.</span> <span class="nav-text">2. 3 授予权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%99%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89-2-%E7%A7%8D%EF%BC%8C%E5%88%86%E5%88%AB%E6%98%AF%E9%80%9A%E8%BF%87%E6%8A%8A%E8%A7%92%E8%89%B2%E8%B5%8B%E4%BA%88%E7%94%A8%E6%88%B7%E7%BB%99%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83%E5%92%8C%E7%9B%B4%E6%8E%A5%E7%BB%99%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83%E3%80%82%E7%94%A8%E6%88%B7%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84"><span class="nav-number">1.4.3.0.1.</span> <span class="nav-text">给用户授权的方式有 2 种，分别是通过把角色赋予用户给用户授权和直接给用户授权。用户是数据库的</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%80%85%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E7%BB%99%E7%94%A8%E6%88%B7%E6%8E%88%E4%BA%88%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E8%B5%84%E6%BA%90%E7%9A%84%E6%9D%83%E9%99%90%EF%BC%8C%E6%9D%A5%E6%8E%A7%E5%88%B6%E4%BD%BF%E7%94%A8%E8%80%85%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%AE%BF%E9%97%AE%EF%BC%8C%E6%B6%88%E9%99%A4%E5%AE%89%E5%85%A8"><span class="nav-number">1.4.3.0.2.</span> <span class="nav-text">使用者，我们可以通过给用户授予访问数据库中资源的权限，来控制使用者对数据库的访问，消除安全</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9A%90%E6%82%A3%E3%80%82"><span class="nav-number">1.4.3.0.3.</span> <span class="nav-text">隐患。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="nav-number">1.4.3.0.4.</span> <span class="nav-text">授权命令：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%A5%E6%9D%83%E9%99%90%E5%A6%82%E6%9E%9C%E5%8F%91%E7%8E%B0%E6%B2%A1%E6%9C%89%E8%AF%A5%E7%94%A8%E6%88%B7%EF%BC%8C%E5%88%99%E4%BC%9A%E7%9B%B4%E6%8E%A5%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E3%80%82"><span class="nav-number">1.4.3.0.5.</span> <span class="nav-text">该权限如果发现没有该用户，则会直接新建一个用户。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AF%94%E5%A6%82%EF%BC%9A"><span class="nav-number">1.4.3.0.6.</span> <span class="nav-text">比如：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%88%91%E4%BB%AC%E5%9C%A8%E5%BC%80%E5%8F%91%E5%BA%94%E7%94%A8%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E7%BB%8F%E5%B8%B8%E4%BC%9A%E9%81%87%E5%88%B0%E4%B8%80%E7%A7%8D%E9%9C%80%E6%B1%82%EF%BC%8C%E5%B0%B1%E6%98%AF%E8%A6%81%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E7%9A%84%E4%B8%8D%E5%90%8C%EF%BC%8C%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E5%92%8C%E7%BA%B5%E5%90%91%E7%9A%84"><span class="nav-number">1.4.3.0.7.</span> <span class="nav-text">我们在开发应用的时候，经常会遇到一种需求，就是要根据用户的不同，对数据进行横向和纵向的</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E3%80%82"><span class="nav-number">1.4.3.0.8.</span> <span class="nav-text">分组。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%80%E8%B0%93%E6%A8%AA%E5%90%91%E7%9A%84%E5%88%86%E7%BB%84%EF%BC%8C%E5%B0%B1%E6%98%AF%E6%8C%87%E7%94%A8%E6%88%B7%E5%8F%AF%E4%BB%A5%E6%8E%A5%E8%A7%A6%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9A%84%E8%8C%83%E5%9B%B4%EF%BC%8C%E6%AF%94%E5%A6%82%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%93%AA%E4%BA%9B%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%9B"><span class="nav-number">1.4.3.0.9.</span> <span class="nav-text">所谓横向的分组，就是指用户可以接触到的数据的范围，比如可以看到哪些表的数据；</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%80%E8%B0%93%E7%BA%B5%E5%90%91%E7%9A%84%E5%88%86%E7%BB%84%EF%BC%8C%E5%B0%B1%E6%98%AF%E6%8C%87%E7%94%A8%E6%88%B7%E5%AF%B9%E6%8E%A5%E8%A7%A6%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E8%83%BD%E8%AE%BF%E9%97%AE%E5%88%B0%E4%BB%80%E4%B9%88%E7%A8%8B%E5%BA%A6%EF%BC%8C%E6%AF%94%E5%A6%82%E8%83%BD%E7%9C%8B%E3%80%81%E8%83%BD%E6%94%B9%EF%BC%8C%E7%94%9A%E8%87%B3%E6%98%AF"><span class="nav-number">1.4.3.0.10.</span> <span class="nav-text">所谓纵向的分组，就是指用户对接触到的数据能访问到什么程度，比如能看、能改，甚至是</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E3%80%82"><span class="nav-number">1.4.3.0.11.</span> <span class="nav-text">删除。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E6%9F%A5%E7%9C%8B%E6%9D%83%E9%99%90"><span class="nav-number">1.4.4.</span> <span class="nav-text">2. 4 查看权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="nav-number">1.4.4.0.1.</span> <span class="nav-text">查看当前用户权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%9F%90%E7%94%A8%E6%88%B7%E7%9A%84%E5%85%A8%E5%B1%80%E6%9D%83%E9%99%90"><span class="nav-number">1.4.4.0.2.</span> <span class="nav-text">查看某用户的全局权限</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-%E6%94%B6%E5%9B%9E%E6%9D%83%E9%99%90"><span class="nav-number">1.4.5.</span> <span class="nav-text">2. 5 收回权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%B6%E5%9B%9E%E6%9D%83%E9%99%90%E5%B0%B1%E6%98%AF%E5%8F%96%E6%B6%88%E5%B7%B2%E7%BB%8F%E8%B5%8B%E4%BA%88%E7%94%A8%E6%88%B7%E7%9A%84%E6%9F%90%E4%BA%9B%E6%9D%83%E9%99%90%E3%80%82-%E6%94%B6%E5%9B%9E%E7%94%A8%E6%88%B7%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E6%9D%83%E9%99%90%E5%8F%AF%E4%BB%A5%E5%9C%A8%E4%B8%80%E5%AE%9A%E7%A8%8B%E5%BA%A6%E4%B8%8A%E4%BF%9D%E8%AF%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E5%85%A8"><span class="nav-number">1.4.5.0.1.</span> <span class="nav-text">收回权限就是取消已经赋予用户的某些权限。 收回用户不必要的权限可以在一定程度上保证系统的安全</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B"><span class="nav-number">1.4.5.0.2.</span> <span class="nav-text">举例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%9A%E9%A1%BB%E7%94%A8%E6%88%B7%E9%87%8D%E6%96%B0%E7%99%BB%E5%BD%95%E5%90%8E%E6%89%8D%E8%83%BD%E7%94%9F%E6%95%88"><span class="nav-number">1.4.5.0.3.</span> <span class="nav-text">注意：须用户重新登录后才能生效</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E6%9D%83%E9%99%90%E8%A1%A8"><span class="nav-number">1.5.</span> <span class="nav-text">3. 权限表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-user%E8%A1%A8"><span class="nav-number">1.5.1.</span> <span class="nav-text">3.1 user表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E4%BA%9B%E5%AD%97%E6%AE%B5%E5%8F%AF%E4%BB%A5%E5%88%86%E6%88%90-4-%E7%B1%BB%EF%BC%8C%E5%88%86%E5%88%AB%E6%98%AF%E8%8C%83%E5%9B%B4%E5%88%97%EF%BC%88%E6%88%96%E7%94%A8%E6%88%B7%E5%88%97%EF%BC%89%E3%80%81%E6%9D%83%E9%99%90%E5%88%97%E3%80%81%E5%AE%89%E5%85%A8%E5%88%97%E5%92%8C%E8%B5%84%E6%BA%90%E6%8E%A7%E5%88%B6%E5%88%97%E3%80%82"><span class="nav-number">1.5.1.0.1.</span> <span class="nav-text">这些字段可以分成 4 类，分别是范围列（或用户列）、权限列、安全列和资源控制列。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E8%8C%83%E5%9B%B4%E5%88%97%EF%BC%88%E6%88%96%E7%94%A8%E6%88%B7%E5%88%97%EF%BC%89"><span class="nav-number">1.5.1.0.2.</span> <span class="nav-text">1 .范围列（或用户列）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%94%A8%E6%88%B7-%E4%BB%A5%E5%88%97%E7%9A%84%E6%96%B9%E5%BC%8F%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%EF%BC%9A"><span class="nav-number">1.5.1.0.3.</span> <span class="nav-text">查看用户, 以列的方式显示数据：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E7%89%B9%E5%AE%9A%E5%AD%97%E6%AE%B5%EF%BC%9A"><span class="nav-number">1.5.1.0.4.</span> <span class="nav-text">查询特定字段：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-db%E8%A1%A8"><span class="nav-number">1.5.2.</span> <span class="nav-text">3.2 db表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-tables-priv%E8%A1%A8%E5%92%8Ccolumns-priv%E8%A1%A8"><span class="nav-number">1.5.3.</span> <span class="nav-text">3.3 tables_priv表和columns_priv表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-procs-priv%E8%A1%A8"><span class="nav-number">1.5.4.</span> <span class="nav-text">3.4 procs_priv表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6-%E4%BA%86%E8%A7%A3"><span class="nav-number">1.6.</span> <span class="nav-text">4. 访问控制(了解)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E8%BF%9E%E6%8E%A5%E6%A0%B8%E5%AE%9E%E9%98%B6%E6%AE%B5"><span class="nav-number">1.6.1.</span> <span class="nav-text">4. 1 连接核实阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E8%AF%B7%E6%B1%82%E6%A0%B8%E5%AE%9E%E9%98%B6%E6%AE%B5"><span class="nav-number">1.6.2.</span> <span class="nav-text">4. 2 请求核实阶段</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%80%E6%97%A6%E5%BB%BA%E7%AB%8B%E4%BA%86%E8%BF%9E%E6%8E%A5%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B0%B1%E8%BF%9B%E5%85%A5%E4%BA%86%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%9A%84%E9%98%B6%E6%AE%B5-2-%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B7%E6%B1%82%E6%A0%B8%E5%AE%9E%E9%98%B6%E6%AE%B5%E3%80%82%E5%AF%B9%E6%AD%A4%E8%BF%9E%E6%8E%A5%E4%B8%8A%E8%BF%9B%E6%9D%A5%E7%9A%84%E6%AF%8F%E4%B8%AA%E8%AF%B7"><span class="nav-number">1.6.2.0.1.</span> <span class="nav-text">一旦建立了连接，服务器就进入了访问控制的阶段 2 ，也就是请求核实阶段。对此连接上进来的每个请</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B1%82%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A3%80%E6%9F%A5%E8%AF%A5%E8%AF%B7%E6%B1%82%E8%A6%81%E6%89%A7%E8%A1%8C%E4%BB%80%E4%B9%88%E6%93%8D%E4%BD%9C%E3%80%81%E6%98%AF%E5%90%A6%E6%9C%89%E8%B6%B3%E5%A4%9F%E7%9A%84%E6%9D%83%E9%99%90%E6%9D%A5%E6%89%A7%E8%A1%8C%E5%AE%83%EF%BC%8C%E8%BF%99%E6%AD%A3%E6%98%AF%E9%9C%80%E8%A6%81%E6%8E%88%E6%9D%83%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%9D%83%E9%99%90%E5%88%97%E5%8F%91"><span class="nav-number">1.6.2.0.2.</span> <span class="nav-text">求，服务器检查该请求要执行什么操作、是否有足够的权限来执行它，这正是需要授权表中的权限列发</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86"><span class="nav-number">1.7.</span> <span class="nav-text">5. 角色管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E8%A7%92%E8%89%B2%E7%9A%84%E7%90%86%E8%A7%A3"><span class="nav-number">1.7.1.</span> <span class="nav-text">5. 1 角色的理解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E8%A7%92%E8%89%B2%E7%9A%84%E7%9B%AE%E7%9A%84%E6%98%AF%E6%96%B9%E4%BE%BF%E7%AE%A1%E7%90%86%E6%8B%A5%E6%9C%89%E7%9B%B8%E5%90%8C%E6%9D%83%E9%99%90%E7%9A%84%E7%94%A8%E6%88%B7%E3%80%82-%E6%81%B0%E5%BD%93%E7%9A%84%E6%9D%83%E9%99%90%E8%AE%BE%E5%AE%9A%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%A1%AE%E4%BF%9D%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%EF%BC%8C%E8%BF%99%E6%98%AF%E8%87%B3%E5%85%B3"><span class="nav-number">1.7.1.0.1.</span> <span class="nav-text">引入角色的目的是方便管理拥有相同权限的用户。 恰当的权限设定，可以确保数据的安全性，这是至关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%87%8D%E8%A6%81%E7%9A%84-%E3%80%82"><span class="nav-number">1.7.1.0.2.</span> <span class="nav-text">重要的 。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E5%88%9B%E5%BB%BA%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.2.</span> <span class="nav-text">5. 2 创建角色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%92%E8%89%B2%E4%BD%BF%E7%94%A8CREATE-ROLE%E8%AF%AD%E5%8F%A5%EF%BC%8C%E8%AF%AD%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.7.2.0.1.</span> <span class="nav-text">创建角色使用CREATE ROLE语句，语法如下：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-%E7%BB%99%E8%A7%92%E8%89%B2%E8%B5%8B%E4%BA%88%E6%9D%83%E9%99%90"><span class="nav-number">1.7.3.</span> <span class="nav-text">5. 3 给角色赋予权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%92%E8%89%B2%E4%B9%8B%E5%90%8E%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%BF%99%E4%B8%AA%E8%A7%92%E8%89%B2%E6%98%AF%E6%B2%A1%E6%9C%89%E4%BB%BB%E4%BD%95%E6%9D%83%E9%99%90%E7%9A%84%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E7%BB%99%E8%A7%92%E8%89%B2%E6%8E%88%E6%9D%83%E3%80%82%E7%BB%99%E8%A7%92%E8%89%B2%E6%8E%88%E6%9D%83%E7%9A%84%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84%E6%98%AF%EF%BC%9A"><span class="nav-number">1.7.3.0.1.</span> <span class="nav-text">创建角色之后，默认这个角色是没有任何权限的，我们需要给角色授权。给角色授权的语法结构是：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0-1-%EF%BC%9A%E6%88%91%E4%BB%AC%E7%8E%B0%E5%9C%A8%E6%83%B3%E7%BB%99%E7%BB%8F%E7%90%86%E8%A7%92%E8%89%B2%E6%8E%88%E4%BA%88%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF%E8%A1%A8%E3%80%81%E7%9B%98%E7%82%B9%E8%A1%A8%E5%92%8C%E5%BA%94%E4%BB%98%E8%B4%A6%E6%AC%BE%E8%A1%A8%E7%9A%84%E5%8F%AA%E8%AF%BB%E6%9D%83%E9%99%90%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="nav-number">1.7.3.0.2.</span> <span class="nav-text">练习 1 ：我们现在想给经理角色授予商品信息表、盘点表和应付账款表的只读权限，就可以用下面的代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%A5%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="nav-number">1.7.3.0.3.</span> <span class="nav-text">来实现：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-%E6%9F%A5%E7%9C%8B%E8%A7%92%E8%89%B2%E7%9A%84%E6%9D%83%E9%99%90"><span class="nav-number">1.7.4.</span> <span class="nav-text">5. 4 查看角色的权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B5%8B%E4%BA%88%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E4%B9%8B%E5%90%8E%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87-SHOW-GRANTS-%E8%AF%AD%E5%8F%A5%EF%BC%8C%E6%9D%A5%E6%9F%A5%E7%9C%8B%E6%9D%83%E9%99%90%E6%98%AF%E5%90%A6%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F%E4%BA%86%EF%BC%9A"><span class="nav-number">1.7.4.0.1.</span> <span class="nav-text">赋予角色权限之后，我们可以通过 SHOW GRANTS 语句，来查看权限是否创建成功了：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AA%E8%A6%81%E4%BD%A0%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA%E8%A7%92%E8%89%B2%EF%BC%8C%E7%B3%BB%E7%BB%9F%E5%B0%B1%E4%BC%9A%E8%87%AA%E5%8A%A8%E7%BB%99%E4%BD%A0%E4%B8%80%E4%B8%AA%E2%80%9CUSAGE%E2%80%9D%E6%9D%83%E9%99%90%EF%BC%8C%E6%84%8F%E6%80%9D%E6%98%AF%E8%BF%9E%E6%8E%A5%E7%99%BB%E5%BD%95%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%9D%83%E9%99%90%E3%80%82%E4%BB%A3%E7%A0%81%E7%9A%84"><span class="nav-number">1.7.4.0.2.</span> <span class="nav-text">只要你创建了一个角色，系统就会自动给你一个“USAGE”权限，意思是连接登录数据库的权限。代码的</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-5-%E5%9B%9E%E6%94%B6%E8%A7%92%E8%89%B2%E7%9A%84%E6%9D%83%E9%99%90"><span class="nav-number">1.7.5.</span> <span class="nav-text">5. 5 回收角色的权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%92%E8%89%B2%E6%8E%88%E6%9D%83%E5%90%8E%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%AF%B9%E8%A7%92%E8%89%B2%E7%9A%84%E6%9D%83%E9%99%90%E8%BF%9B%E8%A1%8C%E7%BB%B4%E6%8A%A4%EF%BC%8C%E5%AF%B9%E6%9D%83%E9%99%90%E8%BF%9B%E8%A1%8C%E6%B7%BB%E5%8A%A0%E6%88%96%E6%92%A4%E9%94%80%E3%80%82%E6%B7%BB%E5%8A%A0%E6%9D%83%E9%99%90%E4%BD%BF%E7%94%A8GRANT%E8%AF%AD%E5%8F%A5%EF%BC%8C%E4%B8%8E%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.5.0.1.</span> <span class="nav-text">角色授权后，可以对角色的权限进行维护，对权限进行添加或撤销。添加权限使用GRANT语句，与角色</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%88%E6%9D%83%E7%9B%B8%E5%90%8C%E3%80%82%E6%92%A4%E9%94%80%E8%A7%92%E8%89%B2%E6%88%96%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E4%BD%BF%E7%94%A8REVOKE%E8%AF%AD%E5%8F%A5%E3%80%82"><span class="nav-number">1.7.5.0.2.</span> <span class="nav-text">授权相同。撤销角色或角色权限使用REVOKE语句。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E4%BA%86%E8%A7%92%E8%89%B2%E7%9A%84%E6%9D%83%E9%99%90%EF%BC%8C%E4%BC%9A%E5%BD%B1%E5%93%8D%E6%8B%A5%E6%9C%89%E8%AF%A5%E8%A7%92%E8%89%B2%E7%9A%84%E8%B4%A6%E6%88%B7%E7%9A%84%E6%9D%83%E9%99%90%E3%80%82"><span class="nav-number">1.7.5.0.3.</span> <span class="nav-text">修改了角色的权限，会影响拥有该角色的账户的权限。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%92%A4%E9%94%80%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E7%9A%84SQL%E8%AF%AD%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.7.5.0.4.</span> <span class="nav-text">撤销角色权限的SQL语法如下：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-%E5%88%A0%E9%99%A4%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.6.</span> <span class="nav-text">5. 6 删除角色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BD%93%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%AF%B9%E4%B8%9A%E5%8A%A1%E9%87%8D%E6%96%B0%E6%95%B4%E5%90%88%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%8F%AF%E8%83%BD%E5%B0%B1%E9%9C%80%E8%A6%81%E5%AF%B9%E4%B9%8B%E5%89%8D%E5%88%9B%E5%BB%BA%E7%9A%84%E8%A7%92%E8%89%B2%E8%BF%9B%E8%A1%8C%E6%B8%85%E7%90%86%EF%BC%8C%E5%88%A0%E9%99%A4%E4%B8%80%E4%BA%9B%E4%B8%8D%E4%BC%9A%E5%86%8D%E4%BD%BF%E7%94%A8%E7%9A%84%E8%A7%92"><span class="nav-number">1.7.6.0.1.</span> <span class="nav-text">当我们需要对业务重新整合的时候，可能就需要对之前创建的角色进行清理，删除一些不会再使用的角</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%89%B2%E3%80%82%E5%88%A0%E9%99%A4%E8%A7%92%E8%89%B2%E7%9A%84%E6%93%8D%E4%BD%9C%E5%BE%88%E7%AE%80%E5%8D%95%EF%BC%8C%E4%BD%A0%E5%8F%AA%E8%A6%81%E6%8E%8C%E6%8F%A1%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84%E5%B0%B1%E8%A1%8C%E4%BA%86%E3%80%82"><span class="nav-number">1.7.6.0.2.</span> <span class="nav-text">色。删除角色的操作很简单，你只要掌握语法结构就行了。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BD%A0%E5%88%A0%E9%99%A4%E4%BA%86%E8%A7%92%E8%89%B2%EF%BC%8C%E9%82%A3%E4%B9%88%E7%94%A8%E6%88%B7%E4%B9%9F%E5%B0%B1%E5%A4%B1%E5%8E%BB%E4%BA%86%E9%80%9A%E8%BF%87%E8%BF%99%E4%B8%AA%E8%A7%92%E8%89%B2%E6%89%80%E8%8E%B7%E5%BE%97%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83%E9%99%90%E3%80%82"><span class="nav-number">1.7.6.0.3.</span> <span class="nav-text">注意，如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-7-%E7%BB%99%E7%94%A8%E6%88%B7%E8%B5%8B%E4%BA%88%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.7.</span> <span class="nav-text">5. 7 给用户赋予角色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%92%E8%89%B2%E5%88%9B%E5%BB%BA%E5%B9%B6%E6%8E%88%E6%9D%83%E5%90%8E%EF%BC%8C%E8%A6%81%E8%B5%8B%E7%BB%99%E7%94%A8%E6%88%B7%E5%B9%B6%E5%A4%84%E4%BA%8E%E6%BF%80%E6%B4%BB%E7%8A%B6%E6%80%81%E6%89%8D%E8%83%BD%E5%8F%91%E6%8C%A5%E4%BD%9C%E7%94%A8%E3%80%82%E7%BB%99%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E8%A7%92%E8%89%B2%E5%8F%AF%E4%BD%BF%E7%94%A8GRANT%E8%AF%AD%E5%8F%A5%EF%BC%8C%E8%AF%AD"><span class="nav-number">1.7.7.0.1.</span> <span class="nav-text">角色创建并授权后，要赋给用户并处于激活状态才能发挥作用。给用户添加角色可使用GRANT语句，语</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%95%E5%BD%A2%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.7.7.0.2.</span> <span class="nav-text">法形式如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%88-2-%EF%BC%89%E6%B7%BB%E5%8A%A0%E5%AE%8C%E6%88%90%E5%90%8E%E4%BD%BF%E7%94%A8SHOW%E8%AF%AD%E5%8F%A5%E6%9F%A5%E7%9C%8B%E6%98%AF%E5%90%A6%E6%B7%BB%E5%8A%A0%E6%88%90%E5%8A%9F%EF%BC%8CSQL%E8%AF%AD%E5%8F%A5%E5%A6%82%E4%B8%8B%E3%80%82"><span class="nav-number">1.7.7.0.3.</span> <span class="nav-text">（ 2 ）添加完成后使用SHOW语句查看是否添加成功，SQL语句如下。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-8-%E6%BF%80%E6%B4%BB%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.8.</span> <span class="nav-text">5. 8 激活角色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B%EF%BC%9A%E4%BD%BF%E7%94%A8SET-DEFAULT-ROLE%E4%B8%BA%E4%B8%8B%E9%9D%A2-4-%E4%B8%AA%E7%94%A8%E6%88%B7%E9%BB%98%E8%AE%A4%E6%BF%80%E6%B4%BB%E6%89%80%E6%9C%89%E5%B7%B2%E6%8B%A5%E6%9C%89%E7%9A%84%E8%A7%92%E8%89%B2%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.7.8.0.1.</span> <span class="nav-text">举例：使用SET DEFAULT ROLE为下面 4 个用户默认激活所有已拥有的角色如下：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%EF%BC%9A"><span class="nav-number">1.7.8.0.2.</span> <span class="nav-text">设置：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E6%9D%A1-SQL-%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%84%8F%E6%80%9D%E6%98%AF%EF%BC%8C%E5%AF%B9%E6%89%80%E6%9C%89%E8%A7%92%E8%89%B2%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB%E3%80%82%E8%BF%90%E8%A1%8C%E8%BF%99%E6%9D%A1%E8%AF%AD%E5%8F%A5%E4%B9%8B%E5%90%8E%EF%BC%8C%E7%94%A8%E6%88%B7%E6%89%8D%E7%9C%9F%E6%AD%A3%E6%8B%A5%E6%9C%89%E4%BA%86%E8%B5%8B%E4%BA%88%E8%A7%92%E8%89%B2%E7%9A%84%E6%89%80%E6%9C%89"><span class="nav-number">1.7.8.0.3.</span> <span class="nav-text">这条 SQL 语句的意思是，对所有角色永久激活。运行这条语句之后，用户才真正拥有了赋予角色的所有</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E3%80%82"><span class="nav-number">1.7.8.0.4.</span> <span class="nav-text">权限。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-9-%E6%92%A4%E9%94%80%E7%94%A8%E6%88%B7%E7%9A%84%E8%A7%92%E8%89%B2"><span class="nav-number">1.7.9.</span> <span class="nav-text">5.9 撤销用户的角色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%92%A4%E9%94%80%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E7%9A%84SQL%E8%AF%AD%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="nav-number">1.7.9.0.1.</span> <span class="nav-text">撤销用户角色的SQL语法如下：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-10-%E8%AE%BE%E7%BD%AE%E5%BC%BA%E5%88%B6%E8%A7%92%E8%89%B2-mandatory-role"><span class="nav-number">1.7.10.</span> <span class="nav-text">5.10 设置强制角色(mandatory role)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-1-%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E5%89%8D%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.7.10.0.1.</span> <span class="nav-text">方式 1 ：服务启动前设置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-2-%EF%BC%9A%E8%BF%90%E8%A1%8C%E6%97%B6%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.7.10.0.2.</span> <span class="nav-text">方式 2 ：运行时设置</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wenchao"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">wenchao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wangwenchao1991" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangwenchao1991" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/349205260" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;349205260" rel="noopener" target="_blank"><i class="iconfont icon-bilibili fa-fw"></i>Bilibili</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wenchao</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
